<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastermind</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="container">
        <!-- Left Panel -->
        <div id="left" class="section">
            <h1>ğŸ¯Mastermind</h1>
            <div class="button-group">
                <div class="button-group" style="border: 0.1vw solid var(--cell-border);">
                    <label for="slotInput">No of Slots:
                        <input type="number" id="slotInput" min="1" max="12" value="4">
                    </label>
                    <label for="colorInput">No of Colors:
                        <input type="number" id="colorInput" min="1" max="20" value="6">

                    </label>
                    <label>Max Attempts:
                        <input type="number" id="maxAttempts" min="4" max="20" value="12">
                    </label>
                    <label id="allowedDuplicates">ğŸ‘¯ Allow Duplicate Colors
                        <input type="checkbox" id="buttonDuplicate" checked>
                    </label>
                    <button id="buttonStart">ğŸ”„ New Game</button>
                    <p id="diffcultydisplay">Very Easy</p>
                </div>
                <button id="undo-last">â†©ï¸ Undo</button>
                <button id="buttonEnd">ğŸ”š End</button>
                <button id="toggle-theme">â˜€ï¸ Light</button>
                <button id="toggle-sound">ğŸ”‡ Music:Off"</button>
                <button class="primary" id="local-toggle-leaderboard">ğŸ† Local Leaderboard</button>
                <button class="primary" id="toggle-leaderboard">ğŸŒ Global Leaderboard</button>
              <div id="timerdisplay">â±ï¸ 00:00:00</div>
                <div class="message" id="output">
                    Please Click on Circle to select your secreate colors and press Start
                </div>
            </div>
        </div>
        <!-- Right Grid -->
        <div id="right">
            <div class="board" id="secretBoard"></div>
            <div id="game"> 
                <div id="colorPopup" class="popup"></div>
                <div id="visualGuesses"></div>
            </div>
            <div class="log" id="log"></div>
        </div>
    </div>
    <div id="leaderboardPopup" class="popupWindow">
    </div>
    <div id="localleaderboardPopup" class="popupWindow">
    </div>
    <!-- Display winning text -->
    <div id="winText">ğŸ‰ You Won! ğŸ‰</div>
    <!-- fire crackers canvas -->
    <canvas id="fireworksCanvas"></canvas>
    <!-- <script type="module" src="js/script.js"></script> -->
    <script type="module" src="js/script.js"></script>
    <script type="module">
        import { renderLeaderboard, saveScore, sortTable } from '../../leaderboard/leaderboard.js';
    
        window.sortTable = sortTable;
        window.submitScore = async function (player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at) {
          try {
            await saveScore(player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at);
          } catch (e) {
            document.getElementById("msg").textContent = 'Error saving score in global leaderboard:' + e;
          }
        };
        document.addEventListener('DOMContentLoaded', () => {
          renderLeaderboard('5inarow');
        });
      </script>
    
      <script type="module">
        import { localrenderLeaderboard } from '../../leaderboard/localleaderboard.js';
        document.addEventListener('DOMContentLoaded', () => {
                localrenderLeaderboard();
            });
      </script>
    
      <script>
        fetch('../../leaderboard/leaderboard.html')
          .then(response => response.text())
          .then(htmlText => {
            document.getElementById('leaderboardPopup').innerHTML = htmlText;
          });
    
        fetch('../../leaderboard/localleaderboard.html')
          .then(response => response.text())
          .then(htmlText => {
            document.getElementById('localleaderboardPopup').innerHTML = htmlText;
          });
        document.getElementById("leaderboardPopup").style.display = 'none';
        document.getElementById("localleaderboardPopup").style.display = 'none';
    
        document.getElementById("toggle-leaderboard").addEventListener("click", () => {
          if (document.getElementById("toggle-leaderboard").style.display === 'block') {
            // document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
            document.getElementById("leaderboardPopup").style.display = 'none';
            return;
          } else {
            // document.getElementById("toggle-leaderboard").textContent = "Hide Global Leaderboard";
            document.getElementById("leaderboardPopup").style.display = 'block';
            loadCSS()
          }
        });
    
        document.getElementById("local-toggle-leaderboard").addEventListener("click", () => {
          if (document.getElementById("leaderboardPopup").style.display === 'block') {
            // document.getElementById("local-toggle-leaderboard").textContent = "Local Leaderboard";
            document.getElementById("localleaderboardPopup").style.display = 'none';
            return;
          } else {
            // document.getElementById("toggle-leaderboard").textContent = "Hide Leaderboard";
            document.getElementById("localleaderboardPopup").style.display = 'block';
            loadCSS();
          }
        });
    
        function loadCSS() {
          var head = document.head;
          var link = document.createElement('link');
          link.rel = 'stylesheet';
          link.type = 'text/css';
          link.href = '../../leaderboard/leaderboard.css';
          head.appendChild(link);
        }
      </script>
</body>

</html>