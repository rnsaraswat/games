<!doctype html>
<html lang="hi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sudoku</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app">
        <div class="main">
            <aside class="controls">
                <h1>Sudoku</h1>
                <div style="display: inline-block;">
                    <label>Board (N Ã— N)
                        <select id="sizeSel">
                            <!-- standard ones -->
                            <option value="4|2|2">4Ã—4 [2Ã—2]</option>
                            <option value="6|2|3">6Ã—6 [2x3]</option>
                            <option value="8|2|4">8Ã—8 [2x4]</option>
                            <option value="9|3|3" selected>9Ã—9 [3Ã—3]</option>
                            <option value="10|2|5">10Ã—10 [2x5]</option>
                            <option value="12|3|4">12Ã—12 [3x4]</option>
                            <option value="14|2|7">14Ã—14 [2x7]</option>
                            <option value="15|3|5">15Ã—15 [3x5]</option>
                            <option value="16|4|4">16Ã—16 [4Ã—4]</option>
                            <option value="18|3|6">18Ã—18 [3x6]</option>
                            <option value="20|4|5">20Ã—20 [4x5]</option>
                            <option value="21|3|7">21Ã—21 [3x7]</option>
                            <option value="22|2|11">22Ã—22 [2x11]</option>
                            <option value="24|4|6">24Ã—24 [4x6]</option>
                            <option value="25|5|5">25Ã—25 [5Ã—5]</option>
                        </select>
                    </label>
                    <label>Difficulty
                        <select id="diffSel">
                            <option value="learner">ğŸ“– Learner</option>
                            <option value="easy">ğŸ˜Š Easy</option>
                            <option value="medium" selected>ğŸ¤” Medium</option>
                            <option value="hard">ğŸ¤¯ Hard</option>
                            <option value="expert">ğŸ§‘â€ğŸ”¬ Expert</option>
                        </select>
                    </label>
                </div>
                <div style="display: inline-block;">
                    <label><input type="checkbox" id="notesToggle"> Notes âœ</label>

                    <button id="newBtn" class="primary">ğŸ”„ New Game</button>
                    <button id="pauseBtn" class="btn">â¸ Pause</button>
                    <button id="resetBtn" class="btn">ğŸ”„ Reset</button>
                    <button id="undoBtn" class="btn">â†¶ Undo</button>
                    <button id="redoBtn" class="btn">â†· Redo</button>
                    <button id="hintBtn" class="btn">ğŸ’¡ Hint</button>
                    <button id="checkBtn" class="btn">âœ” Check</button>
                    <button id="errorBtn" class="btn">Error Off</button>
                    <button id="solveBtn" class="btn">ğŸ”“ Solve</button>
                    <button id="themeBtn" class="btn">â˜€ï¸ Light</button>
                    <button class="primary" id="local-toggle-leaderboard">ğŸ† Local Leaderboard</button>
                    <button class="primary" id="toggle-leaderboard">ğŸŒ Global Leaderboard</button>
                    <button class="primary" id="toggle-rules">View Rules</button>
                    <button class="primary" id="toggle-sound">ğŸ”‡ Music:Off"</button>
                    <div id="info">
                        <div id="timerInfo">â± 00:00</div>
                        <div id="mistakeInfo">âŒ 0</div>
                        <div id="filledInfo">Filled: 0</div>
                        <div id="remainInfo">Empty: 0</div>
                        <!-- <div>ğŸ† Best: <b id="best">â€”</b></div> -->
                    </div>
                    <div id="numpad" class="numpad"></div>
                    <div id="statusText">Ready</div>
                    <p id="loading">Loading...</p>
                </div>
            </aside>
            <section class="board-wrap">
                <div id="gridContainer" class="grid"></div>
            </section>
        </div>
    </div>

    <div id="leaderboardPopup" class="popupWindow">
    </div>
    <div id="localleaderboardPopup" class="popupWindow">
    </div>
    <div id="winText">ğŸ‰ Completed ğŸ‰</div>
    <canvas id="confettiCanvas"></canvas>

    <!-- Rules Popup -->
    <div id="rulesPopup" class="popupWindow">
        <div class="popupHeadeer">
            <h3>Game Rules</h3>
            <button class="primary" id="hide-rules">Hide Rules</button>
        </div>
        <div class="popupContent">
            <ul id="RulesBox"></ul>
        </div>
    </div>

    <script type="module" src="js/script.js"></script>
    <script type="module" src="js/rules.js"></script>
    <script type="module">
        import { renderLeaderboard, saveScore, sortTable } from '../../leaderboard/leaderboard.js';
        window.sortTable = sortTable;
        window.submitScore = async function (player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at) {
            try {
                await saveScore(player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at);
            } catch (e) {
                document.getElementById("msg").textContent = 'Error saving score in global leaderboard:' + e;
            }
        };
        document.addEventListener('DOMContentLoaded', () => {
            renderLeaderboard();
        });
        </script>

<script type="module">
    import { localrenderLeaderboard } from '../../leaderboard/localleaderboard.js';
    document.addEventListener('DOMContentLoaded', () => {
        localrenderLeaderboard();
    });
    </script>

    <script>
        fetch('../../leaderboard/leaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('leaderboardPopup').innerHTML = htmlText;
            });

        fetch('../../leaderboard/localleaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('localleaderboardPopup').innerHTML = htmlText;
            });
        document.getElementById("leaderboardPopup").style.display = 'none';
        document.getElementById("localleaderboardPopup").style.display = 'none';

        document.getElementById("toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("toggle-leaderboard").textContent == "Hide Global Leaderboard") {
                document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'none';
                return;
            } else {
                document.getElementById("toggle-leaderboard").textContent = "Hide Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'block';
                loadCSS()
            }
        });

        document.getElementById("local-toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("leaderboardPopup").style.display === 'block') {
                document.getElementById("local-toggle-leaderboard").textContent = "Local Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'none';
                return;
            } else {
                document.getElementById("toggle-leaderboard").textContent = "Hide Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'block';
                loadCSS();
            }
        });

        function loadCSS() {
            var head = document.head;
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = '../../leaderboard/leaderboard.css'; 
            head.appendChild(link);
        }
    </script>
</body>

</html>