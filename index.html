<!doctype html>
<html lang="hi">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ravindra Games Hub</title>
    <meta name="description"
        content="Ravindra Games Hub â€” collection of lightweight web games (TicTacToe, Mastermind, Memory...)">
    <!-- <meta name="theme-color" content="#1a1a1a"> -->
    <!-- <meta name="theme-color" content="#0f172a" id="meta-theme-color"> -->
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="brand">
                <div class="logo">RG</div>
                <div class="title">
                    <h1>Ravindra Games Hub</h1>
                    <p class="lead">Quick browser games â€” PWA-ready</p>
                </div>
            </div>
            <div class="hdrbtns">
                <div class="hdr-child-div">
                    <!-- <a class="chip" id="toggle-leaderboard" href="leaderboard/index.html">Global Leaderboard</a> -->
                    <a class="chip" id="toggle-leaderboard">ğŸŒ Global Leaderboard</a>
                    <a class="chip" href="auth/login.html">Sign in</a>
                </div>
                <div class="hdr-child-div">
                    <button class="chip" id="local-toggle-leaderboard">ğŸ† Local Leaderboard</button>
                    <button class="chip" id="themeToggle">Light</button>
                </div>
                <p id="welcom" class="lead">Welcome</p>
            </div>
        </header>


        <main>
            <section class="grid" id="gamesGrid">
                <!-- <article class="game-card"><img class="thumb" src="/assets/icons/icon-512.png">
                    <div class="content">
                        <h3>Tic Tac Toe</h3>
                        <p>Classic X vs O</p><a class="play-btn" href="games/tictactoe/index.html">Play â–¶</a>
                    </div>
                </article>
                <article class="game-card"><img class="thumb" src="/assets/icons/icon-512.png">
                    <div class="content">
                        <h3>Mastermind</h3>
                        <p>Guess the color code</p><a class="play-btn" href="games/mastermind/index.html">Play â–¶</a>
                    </div>
                </article> -->
            </section>
        </main>


        <footer style="margin-top:20px;color:var(--muted)">Â© 2025 Ravindra</footer>
    </div>
    <div id="leaderboardPopup" class="popupWindow">
    </div>
    <div id="localleaderboardPopup" class="popupWindow">
    </div>

    <!-- <div id="localleaderboardPopup" class="popupWindow">
        <div class="popupHeadeer">
            <div class="controls">
                <h3>ğŸ†Local Leaderboard</h3>
                <button class="chip" id="local-hide-leaderboard">Hide Leaderboard</button>
                <button class="primary" id="clear-leaderboard">Clear Leaderboard</button>
                <a href="../auth/login.html" class="chip">Sign in</a>
            </div>
            <div class="search-container" style="margin-bottom:10px;">
                <label>Filter game: </label>
                <select id="localgameFilter">
                    <option value="all" selected>All</option>
                    <option value="tictactoe">Tic Tac Toe</option>
                    <option value="mastermind">Mastermind</option>
                </select>
                <label>Per page:
                    <select id="localtopSelect">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                </label>
                <input type="text" id="localsearchInput" placeholder="ğŸ” Search player..." />
            </div>
        </div>
        <div class="popupContent">
            <section style="margin-top:12px">
                <div>
                    <table id="leaderboardTable" border="1" cellspacing="0" cellpadding="6"
                        style="width:100%;border-collapse:collapse;text-align:left;">
                        <thead style="background:#222;color:#fff;">
                            <tr>
                                <th>#</th>
                                <th class="sortable">Game
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Winner
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Looser
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Size
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Difficulty
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Score
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Elapsed time
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Date
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Moves
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field1
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field2
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field3
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field4
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="localleaderboardTableBody">
                            <tr>
                                <td colspan="4" style="text-align:center;">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination">
                    <button id="localprevPage">â¬… Prev</button>
                    <span id="localpageInfo"></span>
                    <button id="localnextPage">Next â¡</button>
                </div>
            </section>
        </div>
    </div>

    <div id="leaderboardPopup" class="popupWindow">
        <div class="popupHeadeer">
            <div class="controls">
                <h3>ğŸ†Global Leaderboard</h3>
                <button class="chip" id="hide-leaderboard">Hide Leaderboard</button>
                <a href="../auth/login.html" class="chip">Sign in</a>
            </div>
            <div class="search-container" style="margin-bottom:10px;">
                <label>Filter game: </label>
                <select id="gameFilter">
                    <option value="all" selected>All</option>
                    <option value="tictactoe">Tic Tac Toe</option>
                    <option value="mastermind">Mastermind</option>
                </select>
                <label>Show Top:
                    <select id="topSelect">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                </label>
                <input type="text" id="searchInput" placeholder="ğŸ” Search player..." />
            </div>
        </div>
        <div class="popupContent">
            <section style="margin-top:12px">
                <div>
                    <table id="leaderboardTable" border="1" cellspacing="0" cellpadding="6"
                        style="width:100%;border-collapse:collapse;text-align:left;">
                        <thead style="background:#222;color:#fff;">
                            <tr>
                                <th>#</th>
                                <th class="sortable">Game
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Winner
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Looser
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Size
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Difficulty
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Score
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Elapsed time
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Date
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Moves
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Email
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field1
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field2
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field3
                                  <span class="arrow asc">ğŸ”¼</span>
                                  <span class="arrow desc">ğŸ”½</span>
                                </th>
                                <th class="sortable">Field4
                                    <span class="arrow asc">ğŸ”¼</span>
                                    <span class="arrow desc">ğŸ”½</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="leaderboardTableBody">
                            <tr>
                                <td colspan="4" style="text-align:center;">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination">
                    <button id="prevPage">â¬… Prev</button>
                    <span id="pageInfo"></span>
                    <button id="nextPage">Next â¡</button>
                </div>
            </section>
        </div>
    </div> -->

    <script src="leaderboard/submit-helper.js"></script>

    <script type="module">
        import { renderLeaderboard, saveScore, sortTable } from './leaderboard/leaderboard.js';
        window.sortTable = sortTable;
        window.submitScore = async function (player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at) {
            try {
                await saveScore(player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at);
            } catch (e) {
                document.getElementById("msg").textContent = 'Error saving score in global leaderboard:' + e;
            }
        };
        document.addEventListener('DOMContentLoaded', () => {
            renderLeaderboard();
        });
    </script>

    <script type="module">
        import { localrenderLeaderboard } from './leaderboard/localleaderboard.js';
        document.addEventListener('DOMContentLoaded', () => {
            localrenderLeaderboard();
        });
    </script>

    <!-- <script type="module">
        import { renderLeaderboard } from './leaderboard/leaderboard.js';

        document.getElementById("toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("toggle-leaderboard").textContent == "Hide Global Leaderboard") {
                document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'none';
                return;
            }
            document.getElementById("toggle-leaderboard").textContent = "Hide Global Leaderboard";
            document.getElementById("leaderboardPopup").style.display = 'block';
            renderLeaderboard();
        });

        document.getElementById("hide-leaderboard").addEventListener("click", () => {
            document.getElementById("leaderboardPopup").style.display = "none";
            document.getElementById("hide-leaderboard").textContent = "Hide Leaderboard";
            document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
        });
    </script>
    <script type="module">
        import { localrenderLeaderboard } from './leaderboard/localleaderboard.js';

            //toggle Local leaderboard
            document.getElementById("local-toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("leaderboardPopup").style.display === 'block') {
                document.getElementById("local-toggle-leaderboard").textContent = "Local Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'none';
                return;
            }
            document.getElementById("toggle-leaderboard").textContent = "Hide Leaderboard";
            document.getElementById("leaderboardPopup").style.display = 'block';
            localrenderLeaderboard();
        });
    </script> -->
    <script>
        const games = [
            { id: '4inARow', name: '4inarow', title: '4 in A Row', desc: 'Classic X vs O â€” human or AI', href: 'games/4inARow/index.html' },
            { id: '5inARow', name: '5inarow', title: '5 in A Row', desc: 'Classic X vs O â€” human or AI', href: 'games/5inARow/index.html' },
            { id: 'connect3', name: 'connect3', title: 'Connect 3', desc: 'Classic X vs O â€” human or AI', href: 'games/connect_3/index.html' },
            { id: 'connect4', name: 'connect4', title: 'Connect 4', desc: 'Classic X vs O â€” human or AI', href: 'games/connect_4/index.html' },
            { id: 'sudoku', name: 'sudoku', title: 'Sudoku', desc: 'Solve logic puzzles of various sizes', href: 'games/sudoku/index.html' },
            { id: 'sudokusolver', name: 'sudokusolver', title: 'Sudoku Solver', desc: 'Solve your sudoku Puzzle', href: 'games/sudoku_solver/index.html' },
            { id: 'tictactoe', name: 'tictactoe', title: 'Tic Tac Toe', desc: 'Classic X vs O â€” human or AI', href: 'games/tictactoe/index.html' },
            { id: 'tictactoe1', name: 'tictactoe', title: 'Tic Tac Toe New', desc: 'Classic X vs O â€” human or AI', href: 'games/tictactoe1/index.html' },
            { id: 'tictactoe2', name: 'tictactoe', title: 'Tic Tac Toe simple', desc: 'Classic X vs O â€” human or AI', href: 'games/tictactoe2/index.html' },
            { id: 'tictactoe3', name: 'tictactoe', title: 'Tic Tac Toe', desc: 'Classic X vs O â€” human or AI', href: 'games/tictactoe3/index.html' },
            { id: 'threeinarow', name: 'threeinarow', title: '3 in Row (Tic Tac Toe)', desc: 'Classic X vs O â€” human or AI', href: 'games/threeinarow/index.html' },
            { id: 'mastermind', name: 'mastermind', title: 'Mastermind', desc: 'Guess the color code', href: 'games/mastermind/index.html' },
            { id: 'mastermind1', name: 'mastermind', title: 'Mastermind', desc: 'Guess the color code', href: 'games/mastermindtext/mastermind_text.html' }
            // { id: 'memory', title: 'Memory Game', desc: 'Find pairs before timer ends', href: '/games/memory/index.html' },
            // { id: 'gomoku', title: 'Gomoku (5 in a Row)', desc: 'Beat computer with smart AI', href: '/games/gomoku/index.html' },
            // { id: 'sudoku', title: 'Sudoku', desc: 'Solve logic puzzles of various sizes', href: '/games/sudoku/index.html' },
            // { id: 'slitherlink', title: 'Slitherlink', desc: 'Create a single loop puzzle', href: '/games/slitherlink/index.html' }
        ];

        const player_name = localStorage.getItem('player_name') || 'Guest';

        document.getElementById("welcom").textContent = `Welcome ${player_name}`;
        document.getElementById("welcom").style.alignContent = "center";
        const grid = document.getElementById('gamesGrid');
        games.forEach(g => {
            const card = document.createElement('article');
            card.className = 'game-card';
            card.dataset = g.id;
            card.innerHTML = `<h3>${g.title}</h3><p>${g.desc}</p><div class='actions'><a href='${g.href}' class='play-btn'>Play</a></div>`;
            grid.appendChild(card);
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        function setTheme(t) {
            if (t === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('rg_theme', t);
                themeToggle.textContent = 'ğŸŒ™ Dark'
            }
            if (t === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('rg_theme', t);
                themeToggle.textContent = 'â˜€ï¸ Light'
            }
        }
        if (themeToggle) themeToggle.addEventListener('click', () => setTheme(localStorage.getItem('rg_theme') === 'dark' ? 'light' : 'dark'));
        setTheme(localStorage.getItem('rg_theme') === 'dark' ? 'dark' : 'light');
        // Lazy register SW
        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js').then(() => console.log('sw registered')); }


        fetch('./leaderboard/leaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('leaderboardPopup').innerHTML = htmlText;
            });

        fetch('./leaderboard/localleaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('localleaderboardPopup').innerHTML = htmlText;
            });
        document.getElementById("leaderboardPopup").style.display = 'none';
        document.getElementById("localleaderboardPopup").style.display = 'none';

        document.getElementById("toggle-leaderboard").addEventListener("click", () => {
            // if (document.getElementById("toggle-leaderboard").textContent == "Hide Global Leaderboard") {
            if (document.getElementById("leaderboardPopup").style.display === 'block') {
                document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'none';
                return;
            } else {
                document.getElementById("toggle-leaderboard").textContent = "Hide Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'block';
                // loadCSS()
            }
        });

        document.getElementById("local-toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("leaderboardPopup").style.display === 'block') {
                document.getElementById("local-toggle-leaderboard").textContent = "Local Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'none';
                return;
            } else {
                document.getElementById("toggle-leaderboard").textContent = "Hide Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'block';
                // loadCSS();
            }
        });

        function loadCSS() {
            var head = document.head;
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = './leaderboard/leaderboard.css'; // à¤†à¤ªà¤•à¥€ CSS à¤«à¤¼à¤¾à¤‡à¤² à¤•à¤¾ à¤¨à¤¾à¤®
            head.appendChild(link);
        }

        window.onload = function() {
            loadCSS();
        };
    </script>
</body>

</html>