<!doctype html>
<html lang="hi">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ravindra Games Hub</title>
    <meta name="description"
        content="Ravindra Games Hub ‚Äî collection of lightweight web games (TicTacToe, Mastermind, Memory...)">
    <!-- <meta name="theme-color" content="#1a1a1a"> -->
    <!-- <meta name="theme-color" content="#0f172a" id="meta-theme-color"> -->
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="brand">
                <div class="logo">RG</div>
                <div class="title">
                    <h1>Ravindra Games Hub</h1>
                    <p class="lead">Quick browser games ‚Äî PWA-ready</p>
                </div>
            </div>
            <div class="hdrbtns">
                <div class="hdr-child-div">
                    <!-- <a class="chip" id="toggle-leaderboard" href="leaderboard/index.html">Global Leaderboard</a> -->
                    <a class="chip" id="toggle-leaderboard">üåç Global Leaderboard</a>
                    <a class="chip" href="auth/login.html">Sign in</a>
                </div>
                <div class="hdr-child-div">
                    <button class="chip" id="local-toggle-leaderboard">üèÜ Local Leaderboard</button>
                    <button class="chip" id="themeToggle">‚òÄÔ∏è Light</button>
                </div>
                <p id="welcom" class="lead">Welcome</p>
            </div>
        </header>


        <main>
            <section class="grid" id="gamesGrid">
                <!-- <article class="game-card"><img class="thumb" src="/assets/icons/icon-512.png">
                    <div class="content">
                        <h3>Tic Tac Toe</h3>
                        <p>Classic X vs O</p><a class="play-btn" href="games/tictactoe/index.html">Play ‚ñ∂</a>
                    </div>
                </article>
                <article class="game-card"><img class="thumb" src="/assets/icons/icon-512.png">
                    <div class="content">
                        <h3>Mastermind</h3>
                        <p>Guess the color code</p><a class="play-btn" href="games/mastermind/index.html">Play ‚ñ∂</a>
                    </div>
                </article> -->
            </section>
        </main>


        <footer style="margin-top:20px;color:var(--muted)">¬© 2025 Ravindra</footer>
    </div>
    <div id="leaderboardPopup" class="popupWindow">
    </div>
    <div id="localleaderboardPopup" class="popupWindow">
    </div>
    <script src="leaderboard/submit-helper.js"></script>

    <script type="module">
        import { renderLeaderboard, saveScore, sortTable } from './leaderboard/leaderboard.js';
        window.sortTable = sortTable;
        window.submitScore = async function (player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at) {
            try {
                await saveScore(player_name, player_opponent, email, size, difficulty, game_id, score, elapsed, moves, filed1, filed2, filed3, filed4, created_at);
            } catch (e) {
                document.getElementById("msg").textContent = 'Error saving score in global leaderboard:' + e;
            }
        };
        document.addEventListener('DOMContentLoaded', () => {
            renderLeaderboard();
        });
    </script>

    <script type="module">
        import { localrenderLeaderboard } from './leaderboard/localleaderboard.js';
        document.addEventListener('DOMContentLoaded', () => {
            localrenderLeaderboard();
        });
    </script>


    <script>
        const games = [
            { id: 'rockpaperscissor', name: 'rockpaperscissor', title: 'Rock Paper Scissor', desc: 'Classic & Action-Oriented X vs O', href: 'games/rock_paper_scissor/RPS.html' },
            { id: '4inARow', name: '4inarow', title: '4 in A Row', desc: 'Classic & Action-Oriented X vs O', href: 'games/4inARow/index.html' },
            { id: '5inARow', name: '5inarow', title: '5 in A Row', desc: "It's not just luck, it's strategy", href: 'games/5inARow/index.html' },
            { id: 'connect3', name: 'connect3', title: 'Connect 3', desc: 'Connect Three Classic X vs O', href: 'games/connect_3/index.html' },
            { id: 'connect4', name: 'connect4', title: 'Connect 4', desc: 'Endless ways to connect four X vs O', href: 'games/connect_4/index.html' },
            { id: 'sudoku', name: 'sudoku', title: 'Sudoku', desc: 'Solve logic puzzles of various sizes', href: 'games/sudoku/index.html' },
            { id: 'sudokusolver', name: 'sudokusolver', title: 'Sudoku Solver', desc: 'Solve your sudoku Puzzle', href: 'games/sudoku_solver/index.html' },
            { id: 'tictactoe', name: 'tictactoe', title: 'Tic Tac Toe', desc: 'Simple to learn, tough to master X vs O', href: 'games/tictactoe/index.html' },
            { id: 'tictactoe1', name: 'tictactoe', title: 'Tic Tac Toe New', desc: "One wrong move, and it's over X vs O", href: 'games/tictactoe1/index.html' },
            { id: 'tictactoe2', name: 'tictactoe', title: 'Tic Tac Toe simple', desc: 'Classic X vs O ‚Äî human or AI', href: 'games/tictactoe2/index.html' },
            { id: 'tictactoe3', name: 'tictactoe', title: 'Tic Tac Toe', desc: 'Think ahead. Connect three to Win X vs O', href: 'games/tictactoe3/index.html' },
            { id: 'threeinarow', name: 'threeinarow', title: '3 in Row (Tic Tac Toe)', desc: "It's not just luck, it's strategy X vs O", href: 'games/threeinarow/index.html' },
            { id: 'mastermind', name: 'mastermind', title: 'Mastermind', desc: 'Where great minds converge', href: 'games/mastermind/index.html' },
            { id: 'mastermind1', name: 'mastermind', title: 'Mastermind', desc: 'Thinking without limits', href: 'games/mastermindtext/mastermind_text.html' }
        ];

        const player_name = localStorage.getItem('player_name') || 'Guest';
        // let theme = localStorage.getItem('rg_theme') || 'dark';

        document.getElementById("welcom").textContent = `Welcome ${player_name}`;
        document.getElementById("welcom").style.alignContent = "center";
        const grid = document.getElementById('gamesGrid');
        games.forEach(g => {
            const card = document.createElement('article');
            card.className = 'game-card';
            card.dataset = g.id;
            card.innerHTML = `<h3>${g.title}</h3><p>${g.desc}</p><div class='actions'><a href='${g.href}' class='play-btn'>Play</a></div>`;
            grid.appendChild(card);
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        function setTheme(t) {
            if (t === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('rg_theme', t);
                themeToggle.textContent = 'üåô Dark'
            }
            if (t === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('rg_theme', t);
                themeToggle.textContent = '‚òÄÔ∏è Light'
            }
        }
        if (themeToggle) themeToggle.addEventListener('click', () => setTheme(localStorage.getItem('rg_theme') === 'dark' ? 'light' : 'dark'));
        setTheme(localStorage.getItem('rg_theme') === 'dark' ? 'dark' : 'light');

        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js').then(() => console.log('sw registered')); }


        fetch('./leaderboard/leaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('leaderboardPopup').innerHTML = htmlText;
            });

        fetch('./leaderboard/localleaderboard.html')
            .then(response => response.text())
            .then(htmlText => {
                document.getElementById('localleaderboardPopup').innerHTML = htmlText;
            });
        document.getElementById("leaderboardPopup").style.display = 'none';
        document.getElementById("localleaderboardPopup").style.display = 'none';

        document.getElementById("toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("toggle-leaderboard").style.display === 'block') {
                // document.getElementById("toggle-leaderboard").textContent = "Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'none';
                return;
            } else {
                // document.getElementById("toggle-leaderboard").textContent = "Hide Global Leaderboard";
                document.getElementById("leaderboardPopup").style.display = 'block';
                loadCSS()
            }
        });

        document.getElementById("local-toggle-leaderboard").addEventListener("click", () => {
            if (document.getElementById("leaderboardPopup").style.display === 'block') {
                // document.getElementById("local-toggle-leaderboard").textContent = "Local Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'none';
                return;
            } else {
                // document.getElementById("toggle-leaderboard").textContent = "Hide Leaderboard";
                document.getElementById("localleaderboardPopup").style.display = 'block';
                loadCSS();
            }
        });

        function loadCSS() {
            var head = document.head;
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = './leaderboard/leaderboard.css';
            head.appendChild(link);
        }

        window.onload = function () {
            loadCSS();
        };
    </script>
</body>

</html>