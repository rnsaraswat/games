<!doctype html>
<html lang="hi">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Leaderboard — Ravindra Games Hub</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <div class="container">
        <header style="display:flex;justify-content:space-between;align-items:center">
            <h2>Global Leaderboard</h2>
            <div>
                <a href="../auth/login.html" class="chip">Sign in (Google)</a>
            </div>
        </header>


        <section style="margin-top:12px">
            <label>Filter game: </label>
            <select id="gameFilter">
                <option value="tictactoe" selected>Tic Tac Toe</option>
                <option value="mastermind">Mastermind</option>
            </select>
        </section>


        <section id="leaderboardList" style="margin-top:12px"></section>
        <section>
            <div class="search-container" style="margin-bottom:10px;">
                <input type="text" id="searchInput" placeholder="🔍 Search player..." />
            </div>
            <table id="leaderboardTable" border="1" cellspacing="0" cellpadding="6"
                style="width:100%;border-collapse:collapse;text-align:left;">
                <thead style="background:#222;color:#fff;">
                    <tr>
                        <th>#</th>
                        <th class="sortable">Player
                            <span class="arrow asc">🔼</span>
                            <span class="arrow desc">🔽</span>
                        </th>
                        <th class="sortable">Game
                            <span class="arrow asc">🔼</span>
                            <span class="arrow desc">🔽</span>
                        </th>
                        <th class="sortable">Score
                            <span class="arrow asc">🔼</span>
                            <span class="arrow desc">🔽</span>
                        </th>
                        <th class="sortable">Date
                            <span class="arrow asc">🔼</span>
                            <span class="arrow desc">🔽</span>
                        </th>
                    </tr>
                </thead>
                <tbody id="leaderboardTableBody">
                    <tr>
                        <td colspan="4" style="text-align:center;">Loading...</td>
                    </tr>
                </tbody>
            </table>
        </section>


        <p style="margin-top:18px;color:var(--muted)">Top 10 scores are shown. If Supabase config is missing, local
            scores (from this device) are shown.</p>
    </div>


    <script type="module">
        import { renderLeaderboard, sortTable } from "./leaderboard.js";

        // make sortTable global so onclick in <th> works
        window.sortTable = sortTable;

        // expose submitScore as global for your game to call
        // window.submitScore = async function (game_id, score) {
        //   try {
        //     await saveScore(game_id, score);
        //     console.log('Score saved and leaderboard refreshed');
        //   } catch (e) {
        //     console.error('Error saving score from index:', e);
        //   }
        // };
        const gameid = document.getElementById("gameFilter").value;

        window.addEventListener("DOMContentLoaded", () => {
            renderLeaderboard();
        });
    </script>
    <!-- <script type="module" src="leaderboard.js"></script> -->
</body>

</html>